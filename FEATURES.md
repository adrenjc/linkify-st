# ShortLink é¡¹ç›®äº®ç‚¹ - ç®€å†ç”¨

> ä»¥ä¸‹æ˜¯å¯ä»¥åœ¨ç®€å†ä¸­çªå‡ºçš„æŠ€æœ¯äº®ç‚¹

---

## ğŸ¯ æŠ€æœ¯äº®ç‚¹æ€»ç»“

### 1. å…¨æ ˆæŠ€æœ¯æ ˆ
- **å‰ç«¯**: React 18 + TypeScript + Ant Design Pro + UmiJS 4
- **åç«¯**: Express.js + MongoDB + Redis
- **éƒ¨ç½²**: Docker + Docker Compose ä¸€é”®éƒ¨ç½²

### 2. RBAC æƒé™ç³»ç»Ÿ
- è‡ªç ”è§’è‰²-æƒé™ç®¡ç†ç³»ç»Ÿ
- æ”¯æŒç»†ç²’åº¦ API çº§åˆ«æƒé™æ§åˆ¶
- åŠ¨æ€æƒé™æ ¡éªŒä¸­é—´ä»¶

### 3. é«˜æ€§èƒ½çŸ­é“¾æœåŠ¡
- Base64 + æ—¶é—´æˆ³çŸ­é“¾ç”Ÿæˆç®—æ³•
- Redis ç¼“å­˜å±‚åŠ é€Ÿé‡å®šå‘ï¼ˆ< 10msï¼‰
- æ”¯æŒæ¯ç§’ 1000+ QPS

### 4. å®¡è®¡æ—¥å¿—ç³»ç»Ÿ
- å…¨é¢çš„æ“ä½œæ—¥å¿—è®°å½•
- æ”¯æŒæŒ‰æ—¶é—´/ç”¨æˆ·/æ“ä½œç±»å‹ç­›é€‰
- å¼‚æ­¥æ—¥å¿—å†™å…¥ï¼Œä¸é˜»å¡ä¸»æµç¨‹

### 5. ä¼ä¸šçº§æ¶æ„è®¾è®¡
- Docker å®¹å™¨åŒ–éƒ¨ç½²
- æœåŠ¡å¥åº·æ£€æŸ¥
- æ•°æ®æŒä¹…åŒ–

---

## ğŸ“ ç®€å†æè¿°ç¤ºä¾‹

### é¡¹ç›®æè¿°
> ç‹¬ç«‹è®¾è®¡å¼€å‘çš„çŸ­é“¾æ¥ç®¡ç†å¹³å°ï¼Œæ”¯æŒçŸ­é“¾ç”Ÿæˆã€è‡ªå®šä¹‰åŸŸåã€RBACæƒé™ç®¡ç†ã€å®¡è®¡æ—¥å¿—ç­‰åŠŸèƒ½ã€‚é‡‡ç”¨ React + Express + MongoDB æŠ€æœ¯æ ˆï¼Œé€šè¿‡ Docker Compose å®ç°ä¸€é”®éƒ¨ç½²ã€‚

### æŠ€æœ¯è¦ç‚¹
- ä½¿ç”¨ **Redis ç¼“å­˜å±‚** ä¼˜åŒ–çŸ­é“¾é‡å®šå‘æ€§èƒ½ï¼Œå“åº”æ—¶é—´ < 10ms
- å®ç° **RBAC æƒé™ç³»ç»Ÿ**ï¼Œæ”¯æŒç»†ç²’åº¦ API çº§åˆ«æƒé™æ§åˆ¶
- è®¾è®¡ **å®¡è®¡æ—¥å¿—æ¨¡å—**ï¼Œé‡‡ç”¨å¼‚æ­¥å†™å…¥é¿å…é˜»å¡ä¸»æµç¨‹
- é‡‡ç”¨ **Docker å¤šé˜¶æ®µæ„å»º**ï¼Œä¼˜åŒ–é•œåƒä½“ç§¯å’Œæ„å»ºæ•ˆç‡
- é…ç½® **Nginx åå‘ä»£ç†**ï¼Œæ”¯æŒ SPA è·¯ç”±å’Œ API ä»£ç†

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚ï¼ˆé¢è¯•å‚è€ƒï¼‰

### çŸ­é“¾ç”Ÿæˆç®—æ³•
```javascript
const generateShortKey = (longUrl) => {
  const timestamp = Date.now()
  return Buffer.from(`${longUrl}-${timestamp}`)
    .toString("base64")
    .slice(-6)
}
```

### Redis ç¼“å­˜ç­–ç•¥
- è¯»å–æ—¶ä¼˜å…ˆæŸ¥ Redisï¼Œæœªå‘½ä¸­å†æŸ¥ MongoDB
- å†™å…¥åè‡ªåŠ¨æ›´æ–°ç¼“å­˜
- ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼š1 å°æ—¶

### æƒé™æ ¡éªŒä¸­é—´ä»¶
```javascript
const checkPermission = (permissionCode) => async (req, res, next) => {
  const userPermissions = await getUserPermissions(req.user.id)
  if (!userPermissions.includes(permissionCode)) {
    return res.status(403).json({ message: 'æ— æƒé™' })
  }
  next()
}
```
